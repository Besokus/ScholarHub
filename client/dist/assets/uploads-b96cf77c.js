import{i as d}from"./index-5b5873b3.js";const c=()=>{const o=localStorage.getItem("token"),t=localStorage.getItem("id"),e={};return o&&(e.Authorization=`Bearer ${o}`),t&&(e["X-User-Id"]=t),e},u={uploadImageBatch:async(o,t)=>{const e=new FormData;o.forEach(s=>e.append("images",s));let i=0;const p=()=>new Promise((s,l)=>{const a=new XMLHttpRequest;a.open("POST",`${d}/uploads/images`);const h=c();Object.entries(h).forEach(([r,n])=>a.setRequestHeader(r,String(n))),a.upload.onprogress=r=>{if(r.lengthComputable&&t){const n=Math.round(r.loaded/r.total*100);t(n)}},a.onreadystatechange=()=>{if(a.readyState===4)if(a.status>=200&&a.status<300)try{s(JSON.parse(a.responseText||"{}"))}catch{s({})}else l(new Error(`HTTP ${a.status}`))},a.onerror=()=>l(new Error("Network error")),a.send(e)});for(;i<3;)try{return await p()}catch{i++}throw new Error("Upload failed")},uploadFile:async o=>{const t=new FormData;t.append("file",o);const e=await fetch(`${d}/uploads/files`,{method:"POST",body:t,headers:c()});if(!e.ok)throw new Error("Upload failed");return e.json()},uploadAvatar:async o=>{const t=new FormData;t.append("file",o);const e=await fetch(`${d}/uploads/avatar`,{method:"POST",body:t,headers:c()});if(!e.ok)throw new Error("Upload failed");return e.json()}};export{u as U};
