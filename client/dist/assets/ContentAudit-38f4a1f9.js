import{c as I,r as i,j as e,M as b,s as j,m as f,L as p}from"./index-742c88f7.js";import{S as y}from"./shield-alert-13d01dae.js";import{F as v}from"./file-text-ca3a3a77.js";import{S as A}from"./search-ffc0bb1d.js";import{E as z}from"./eye-6021bed5.js";import{C as w}from"./check-8f48b30b.js";import{T as L}from"./triangle-alert-fc8f0f96.js";import{X as O}from"./x-551ee725.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],k=I("refresh-cw",E),S=({status:a,type:l})=>{let n="bg-slate-100 text-slate-600",d=a;return a==="VIOLATION"?(n="bg-rose-50 text-rose-600 border border-rose-100",d="违规内容"):a==="NORMAL"||a==="ANSWERED"?(n="bg-emerald-50 text-emerald-600 border border-emerald-100",d=l==="resource"?"正常":"已解决"):(a==="PENDING"||a==="UNANSWERED")&&(n="bg-amber-50 text-amber-600 border border-amber-100",d=l==="resource"?"待审核":"待回答"),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${n}`,children:d})},C=()=>{const[a,l]=i.useState([]),[n,d]=i.useState(!0),[x,g]=i.useState(""),[r,m]=i.useState(null);i.useEffect(()=>{h()},[x]);const h=async()=>{var s;d(!0);try{const o=await j.audit.resources({status:x,page:1,pageSize:50});l(((s=o.data)==null?void 0:s.items)||[])}finally{d(!1)}},u=async(s,o)=>{m(s);try{await j.audit.auditResource(String(s),{status:o}),l(c=>c.map(N=>N.id===s?{...N,status:o}:N))}catch{alert("操作失败"),h()}finally{m(null)}},t=async s=>{if(confirm("确定要彻底删除该资源吗？此操作不可恢复。")){m(s);try{await j.audit.deleteResource(String(s)),l(o=>o.filter(c=>c.id!==s))}catch{alert("删除失败")}finally{m(null)}}};return e.jsxs(f.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4 mb-6 bg-white p-4 rounded-xl shadow-sm border border-slate-100",children:[e.jsx("div",{className:"flex items-center bg-slate-50 p-1 rounded-lg border border-slate-200",children:[{k:"",l:"全部"},{k:"NORMAL",l:"正常"},{k:"VIOLATION",l:"违规"},{k:"PENDING",l:"待审核"}].map(s=>e.jsx("button",{onClick:()=>g(s.k),className:`px-4 py-1.5 rounded-md text-sm font-medium transition-all ${x===s.k?"bg-white text-indigo-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:s.l},s.k))}),e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsxs("div",{className:"relative flex-1 sm:flex-none",children:[e.jsx(A,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"搜索资源ID或标题...",className:"pl-9 pr-4 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 w-full sm:w-64"})]}),e.jsx("button",{onClick:h,className:"p-2 text-slate-500 hover:bg-slate-50 rounded-lg transition-colors",title:"刷新",children:e.jsx(k,{size:18,className:n?"animate-spin":""})})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-slate-50/50 text-slate-500 font-medium border-b border-slate-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 w-[40%]",children:"资源信息"}),e.jsx("th",{className:"px-6 py-4",children:"上传者"}),e.jsx("th",{className:"px-6 py-4",children:"上传时间"}),e.jsx("th",{className:"px-6 py-4",children:"状态"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"操作"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50",children:n&&a.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:5,className:"p-12 text-center",children:[e.jsx(p,{className:"animate-spin mx-auto text-indigo-600",size:32}),e.jsx("p",{className:"mt-2 text-slate-400",children:"加载数据中..."})]})}):a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"p-12 text-center text-slate-400",children:"暂无相关资源"})}):a.map(s=>e.jsxs("tr",{className:"hover:bg-slate-50/80 transition-colors group",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-indigo-50 text-indigo-600 rounded-lg shrink-0",children:e.jsx(v,{size:18})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-slate-800 mb-0.5 line-clamp-1 group-hover:text-indigo-600 transition-colors",children:s.title}),e.jsx("div",{className:"text-xs text-slate-400 line-clamp-1",children:s.summary||"无简介"})]})]})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-slate-700 font-medium",children:s.uploaderName}),e.jsxs("div",{className:"text-xs text-slate-400",children:["ID: ",s.id]})]}),e.jsx("td",{className:"px-6 py-4 text-slate-500",children:new Date(s.createTime).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(S,{status:s.status,type:"resource"})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("a",{href:s.fileUrl,target:"_blank",rel:"noreferrer",className:"p-1.5 text-slate-500 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:"查看文件",children:e.jsx(z,{size:16})}),s.status!=="NORMAL"&&e.jsx("button",{onClick:()=>u(s.id,"NORMAL"),disabled:r===s.id,className:"p-1.5 text-emerald-600 hover:bg-emerald-50 rounded-lg transition-colors",title:"通过审核",children:r===s.id?e.jsx(p,{size:16,className:"animate-spin"}):e.jsx(w,{size:16})}),s.status!=="VIOLATION"&&e.jsx("button",{onClick:()=>u(s.id,"VIOLATION"),disabled:r===s.id,className:"p-1.5 text-amber-600 hover:bg-amber-50 rounded-lg transition-colors",title:"标记违规",children:r===s.id?e.jsx(p,{size:16,className:"animate-spin"}):e.jsx(L,{size:16})}),e.jsx("button",{onClick:()=>t(s.id),disabled:r===s.id,className:"p-1.5 text-rose-500 hover:bg-rose-50 rounded-lg transition-colors",title:"删除资源",children:r===s.id?e.jsx(p,{size:16,className:"animate-spin"}):e.jsx(O,{size:16})})]})})]},s.id))})]})})})]})},R=()=>{const[a,l]=i.useState([]),[n,d]=i.useState(!0),[x,g]=i.useState(""),[r,m]=i.useState(null);i.useEffect(()=>{h()},[x]);const h=async()=>{var t;d(!0);try{const s=await j.audit.questions({status:x,page:1,pageSize:50});l(((t=s.data)==null?void 0:t.items)||[])}finally{d(!1)}},u=async(t,s)=>{m(t);try{await j.audit.auditQuestion(String(t),{status:s}),l(o=>o.map(c=>c.id===t?{...c,status:s}:c))}catch{alert("操作失败"),h()}finally{m(null)}};return e.jsxs(f.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4 mb-6 bg-white p-4 rounded-xl shadow-sm border border-slate-100",children:[e.jsx("div",{className:"flex items-center bg-slate-50 p-1 rounded-lg border border-slate-200",children:[{k:"",l:"全部"},{k:"UNANSWERED",l:"待回答"},{k:"ANSWERED",l:"已解决"},{k:"VIOLATION",l:"违规"}].map(t=>e.jsx("button",{onClick:()=>g(t.k),className:`px-4 py-1.5 rounded-md text-sm font-medium transition-all ${x===t.k?"bg-white text-indigo-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:t.l},t.k))}),e.jsx("button",{onClick:h,className:"p-2 text-slate-500 hover:bg-slate-50 rounded-lg transition-colors",children:e.jsx(k,{size:18,className:n?"animate-spin":""})})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-slate-50/50 text-slate-500 font-medium border-b border-slate-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 w-[45%]",children:"问题内容"}),e.jsx("th",{className:"px-6 py-4",children:"提问者"}),e.jsx("th",{className:"px-6 py-4",children:"状态"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"操作"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50",children:n&&a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"p-12 text-center",children:e.jsx(p,{className:"animate-spin mx-auto text-indigo-600"})})}):a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"p-12 text-center text-slate-400",children:"无相关问题"})}):a.map(t=>e.jsxs("tr",{className:"hover:bg-slate-50/80 transition-colors group",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-amber-50 text-amber-600 rounded-lg shrink-0",children:e.jsx(b,{size:18})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-slate-800 mb-0.5 group-hover:text-indigo-600 transition-colors",children:t.title}),e.jsx("div",{className:"text-xs text-slate-400 line-clamp-2",children:t.content})]})]})}),e.jsx("td",{className:"px-6 py-4 text-slate-600",children:t.askerName||"匿名"}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(S,{status:t.status,type:"question"})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[t.status!=="VIOLATION"&&e.jsx("button",{onClick:()=>u(t.id,"VIOLATION"),disabled:r===t.id,className:"p-1.5 text-amber-600 hover:bg-amber-50 rounded-lg transition-colors",title:"标记违规",children:r===t.id?e.jsx(p,{size:16,className:"animate-spin"}):e.jsx(y,{size:16})}),t.status==="VIOLATION"&&e.jsx("button",{onClick:()=>u(t.id,"UNANSWERED"),disabled:r===t.id,className:"p-1.5 text-emerald-600 hover:bg-emerald-50 rounded-lg transition-colors",title:"恢复为正常",children:r===t.id?e.jsx(p,{size:16,className:"animate-spin"}):e.jsx(w,{size:16})})]})})]},t.id))})]})})]})},U=()=>{const[a,l]=i.useState("resources");return e.jsxs("div",{className:"p-6 md:p-8 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-extrabold text-slate-900 tracking-tight",children:"内容风控"}),e.jsxs("p",{className:"text-slate-500 mt-2 flex items-center gap-2",children:[e.jsx(y,{size:16,className:"text-indigo-500"}),"审核并管理平台资源与问答内容，维护社区环境"]})]}),e.jsxs("div",{className:"bg-white p-1.5 rounded-xl inline-flex border border-slate-200 shadow-sm mb-8",children:[e.jsxs("button",{onClick:()=>l("resources"),className:`flex items-center gap-2 px-6 py-2.5 rounded-lg text-sm font-bold transition-all ${a==="resources"?"bg-indigo-600 text-white shadow-md":"text-slate-500 hover:bg-slate-50 hover:text-slate-800"}`,children:[e.jsx(v,{size:18})," 资源审计"]}),e.jsxs("button",{onClick:()=>l("qa"),className:`flex items-center gap-2 px-6 py-2.5 rounded-lg text-sm font-bold transition-all ${a==="qa"?"bg-indigo-600 text-white shadow-md":"text-slate-500 hover:bg-slate-50 hover:text-slate-800"}`,children:[e.jsx(b,{size:18})," 问答审计"]})]}),e.jsx("div",{className:"min-h-[500px]",children:a==="resources"?e.jsx(C,{}):e.jsx(R,{})})]})};export{U as default};
