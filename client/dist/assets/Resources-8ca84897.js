import{c as b,j as e,d as Z,r as n,C as J,m as f,b as A,R as T,e as K}from"./index-742c88f7.js";import{P as B}from"./Pagination-1c3acbf2.js";import{C as Q}from"./courses-cf5571ad.js";import{D as X,A as Y}from"./database-46a36cab.js";import{A as L}from"./index-7dbfdcd6.js";import{S as ee}from"./sparkles-9df1855e.js";import{Z as se}from"./zap-d32f4ce6.js";import{U as te}from"./upload-91c10940.js";import{A as le}from"./arrow-right-797056f3.js";import{L as ae}from"./layers-ac6640bf.js";import{S as ie}from"./search-ffc0bb1d.js";import{F as re}from"./funnel-77631c1c.js";import{E as ne}from"./eye-6021bed5.js";import{D as de}from"./download-e6b51e37.js";import{F as oe,a as ce}from"./file-151d33f9.js";import{F as y}from"./file-text-ca3a3a77.js";import{I as me}from"./image-703b1c2d.js";import"./chevron-left-0e1b0896.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M13.659 22H18a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v11.5",key:"4pqfef"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 12v-1",key:"1ej8lb"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M8 7V6",key:"1nbb54"}],["circle",{cx:"8",cy:"20",r:"2",key:"ckkr5m"}]],ue=b("file-archive",xe);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}]],he=b("file-code",pe);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],fe=b("folder-open",ge);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],je=b("folder",be);function ve({data:c,onSelect:l,current:s}){return e.jsx("div",{className:"space-y-2",children:c.map(a=>e.jsxs("div",{children:[e.jsx("button",{onClick:()=>l(a.id),className:`block w-full text-left px-3 py-2 rounded-lg ${s===a.id?"bg-indigo-50 text-indigo-700":"bg-gray-50 text-gray-700"}`,children:a.name}),a.children&&e.jsx("div",{className:"pl-4 mt-1 space-y-1",children:a.children.map(i=>e.jsx("button",{onClick:()=>l(i.id),className:`block w-full text-left px-3 py-1 rounded ${s===i.id?"bg-indigo-50 text-indigo-700":"text-gray-600"}`,children:i.name},i.id))})]},a.id))})}const we=[{name:"思想政治",keywords:["毛泽东","思修","近代史","马克思","形势与政策","党"]},{name:"体育与健康",keywords:["体育","篮球","足球","羽毛球","健康","运动","击剑"]},{name:"艺术与人文素养",keywords:["艺术","音乐","美术","鉴赏","语文","写作","英语","日语","德语","历史","文化"]},{name:"数学",keywords:["高数","高等数学","线性代数","概率论","统计","微积分","复变函数"]},{name:"物理",keywords:["大学物理","大物","力学","电磁学","光学","热学","量子"]},{name:"化学",keywords:["化学","有机","无机","分析化学"]},{name:"程序设计基础",keywords:["C语言","C++","Java","Python","程序设计","编程","Go","Rust"]},{name:"计算机理论",keywords:["数据结构","算法","离散","操作系统","组成原理","网络","体系结构","编译"]},{name:"软件工程与开发",keywords:["软件工程","数据库","Web","前端","后端","移动应用","测试","设计模式"]},{name:"电路与硬件基础",keywords:["电路","模电","数电","电子","微机","单片机","嵌入式","EDA"]},{name:"信号与控制",keywords:["信号","系统","控制","通信","数字信号"]},{name:"机械与材料",keywords:["机械","制图","工程图学","材料","力学"]},{name:"经济与管理类课程",keywords:["经济","管理","会计","金融","市场","营销"]},{name:"生命科学与医药",keywords:["生物","医学","生理","解剖","药理"]}],ye=()=>e.jsxs("div",{className:"bg-white p-5 rounded-2xl border border-slate-100 shadow-sm animate-pulse flex flex-col h-[180px]",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-xl shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-2 pt-1",children:[e.jsx("div",{className:"h-4 bg-slate-100 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-slate-50 rounded w-1/2"})]})]}),e.jsxs("div",{className:"mt-auto pt-4 border-t border-slate-50 flex gap-2",children:[e.jsx("div",{className:"h-8 flex-1 bg-slate-50 rounded-lg"}),e.jsx("div",{className:"h-8 flex-1 bg-slate-50 rounded-lg"})]})]}),Ne=({title:c})=>{const l=c.toLowerCase();let s=oe,a="text-slate-400",i="bg-slate-100";return l.includes("pdf")?(s=y,a="text-rose-500",i="bg-rose-50"):l.includes("ppt")||l.includes("pptx")?(s=y,a="text-orange-500",i="bg-orange-50"):l.includes("doc")||l.includes("docx")?(s=y,a="text-blue-500",i="bg-blue-50"):l.includes("zip")||l.includes("rar")||l.includes("7z")?(s=ue,a="text-yellow-600",i="bg-yellow-50"):l.includes("png")||l.includes("jpg")?(s=me,a="text-purple-500",i="bg-purple-50"):l.includes("cpp")||l.includes("java")||l.includes("py")||l.includes("js")?(s=he,a="text-emerald-600",i="bg-emerald-50"):l.includes("mp4")&&(s=ce,a="text-sky-600",i="bg-sky-50"),e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${i} ${a} shrink-0 shadow-sm`,children:e.jsx(s,{size:20,strokeWidth:2})})},M=["张同学 刚刚上传了《高等数学笔记》","李同学 下载了《数据结构期末试卷》","今日新增资源 12 份，活跃用户 65+ 人"],ke=["全部","课件","真题","作业","代码","答案","笔记","教材","其他"],Ce=(c,l)=>{const s=c.toLowerCase().trim(),a=(l||"").toLowerCase().replace(".","");return["c","cpp","java","py","js","ts","go","rs","html","css","sql","sh","json","xml","yaml"].includes(a)||s.includes("代码")||s.includes("源码")||s.includes("project")||s.includes("demo")?"代码":s.includes("答案")||s.includes("解析")||s.includes("题解")||s.includes("参考")||s.includes("key")||s.includes("solution")?"答案":s.includes("期末")||s.includes("期中")||s.includes("试卷")||s.includes("真题")||s.includes("考试")||s.includes("exam")||s.includes("test")?"真题":s.includes("作业")||s.includes("实验")||s.includes("习题")||s.includes("练习")||s.includes("homework")||s.includes("lab")||s.includes("assignment")?"作业":s.includes("笔记")||s.includes("复习")||s.includes("总结")||s.includes("提纲")||s.includes("note")||s.includes("summary")?"笔记":s.includes("教材")||s.includes("书籍")||s.includes("课本")||s.includes("电子书")||s.includes("book")||s.includes("textbook")||s.includes("tutorial")?"教材":["ppt","pptx","key"].includes(a)||s.includes("课件")||s.includes("讲义")||s.includes("幻灯片")||s.includes("ppt")||s.includes("slide")||s.includes("chapter")||s.includes("第")&&(s.includes("章")||s.includes("讲"))?"课件":"其他"};function qe(){const{show:c}=Z(),[l,s]=n.useState("全部"),[a,i]=n.useState(""),[x,N]=n.useState("all"),[u,h]=n.useState(1),p=20,[j,_]=n.useState([]),[F,R]=n.useState([]),[$,k]=n.useState(!1),[C,z]=n.useState(""),[S,P]=n.useState(0),[V,D]=n.useState({});n.useEffect(()=>{const t=setInterval(()=>{P(d=>(d+1)%M.length)},4e3);return()=>clearInterval(t)},[]),n.useEffect(()=>{Q.list().then(t=>{const d=t.items||[],m={};d.forEach(o=>{m[o.id]=o.name}),D(m);const r=we.map((o,w)=>{const G=d.filter(g=>o.keywords.some(W=>g.name.includes(W))).map(g=>({id:g.id,name:g.name,isLeaf:!0}));return{id:`cat-${w}`,name:o.name,children:G,isCategory:!0}}),q=new Set(r.flatMap(o=>o.children.map(w=>w.id))),E=d.filter(o=>!q.has(o.id)).map(o=>({id:o.id,name:o.name,isLeaf:!0}));E.length>0&&r.push({id:"cat-others",name:"其他通识课程",children:E,isCategory:!0}),R([{id:"all",name:"全部课程资源",children:r,isOpen:!0}])}).catch(()=>{})},[]),n.useEffect(()=>{(async()=>{try{k(!0),z("");const d=x.startsWith("cat-")||x==="all"?"all":x,m=await T.list({q:a,courseId:d,page:u,pageSize:p});_(m.items.map(r=>({id:r.id,title:r.title,course:r.courseId,tag:Ce(r.title,r.type),fileUrl:r.fileUrl})))}catch{z("加载失败")}finally{k(!1)}})()},[a,x,u,p]);const U=(t,d,m)=>{if(t.preventDefault(),t.stopPropagation(),!d||!m)return;T.downloadLog(String(d)).catch(()=>{});const r=document.createElement("a");r.href=`${K}/api/resources/${d}/download`,r.target="_blank",document.body.appendChild(r),r.click(),document.body.removeChild(r);try{window.dispatchEvent(new CustomEvent("SH_STATS_UPDATED"))}catch{}c("开始下载...","success")},v=n.useMemo(()=>l==="全部"?j:j.filter(t=>t.tag===l),[j,l]),I=v.slice((u-1)*p,u*p),H={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05}}},O={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}};return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 min-h-screen bg-transparent",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 mb-10 items-stretch",children:[e.jsxs("div",{className:"lg:col-span-8 flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500 font-medium mb-3",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(X,{size:14})," 知识库"]}),e.jsx(J,{size:14,className:"opacity-50"}),e.jsx("span",{className:"text-indigo-600 bg-indigo-50 px-2 py-0.5 rounded-md",children:"资源列表"})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("h1",{className:"text-4xl font-extrabold text-slate-900 tracking-tight",children:"资源中心"}),e.jsxs("span",{className:"px-3 py-1 rounded-full bg-slate-100 text-slate-500 text-xs font-bold tracking-wide border border-slate-200",children:[v.length," ITEMS"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-slate-500 max-w-xl text-base leading-relaxed",children:["这里汇聚了全校师生的智慧结晶。您可以按左侧的",e.jsx("b",{children:"课程分类"}),"浏览，或直接搜索特定资料。"]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-1.5 bg-emerald-50 text-emerald-700 rounded-full border border-emerald-100 shadow-sm",children:[e.jsxs("span",{className:"relative flex h-2 w-2",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-emerald-500"})]}),e.jsx("span",{className:"font-bold text-xs uppercase tracking-wider",children:"Live"})]}),e.jsx("div",{className:"h-4 w-px bg-slate-200"}),e.jsx("div",{className:"relative h-6 w-full max-w-md overflow-hidden",children:e.jsx(L,{mode:"wait",children:e.jsxs(f.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},exit:{y:-20,opacity:0},transition:{duration:.3},className:"absolute inset-0 flex items-center text-slate-600 truncate",children:[e.jsx(Y,{size:14,className:"mr-2 text-indigo-500 shrink-0"}),M[S]]},S)})})]})]})]}),e.jsx("div",{className:"lg:col-span-4",children:e.jsxs("div",{className:"relative h-full min-h-[160px] p-6 rounded-3xl bg-slate-900 text-white shadow-xl overflow-hidden group flex flex-col justify-between",children:[e.jsx("div",{className:"absolute top-0 right-0 w-48 h-48 bg-indigo-500/20 rounded-full blur-[60px] -mr-10 -mt-10 group-hover:bg-indigo-400/30 transition-colors duration-700"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-purple-500/10 rounded-full blur-[40px] -ml-10 -mb-10"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-lg bg-white/10 backdrop-blur-md border border-white/10 text-xs font-bold text-indigo-200 uppercase tracking-wider shadow-inner",children:[e.jsx(ee,{size:12,className:"text-yellow-300 fill-yellow-300"}),"Contributor Plan"]}),e.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-full border border-white/5",children:e.jsx(se,{size:18,className:"text-yellow-300",fill:"currentColor"})})]}),e.jsx("h3",{className:"text-xl font-bold leading-tight mt-3 mb-1",children:"分享你的笔记"}),e.jsx("p",{className:"text-sm text-indigo-200/70 font-medium",children:"帮助更多同学，获取社区积分奖励。"})]}),e.jsx("div",{className:"relative z-10 mt-6",children:e.jsxs(A,{to:"/student/resources/upload",className:"flex items-center justify-between w-full px-4 py-3 bg-white hover:bg-indigo-50 text-indigo-900 rounded-xl text-sm font-bold transition-all shadow-lg group/btn",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(te,{size:16})," 上传新资源"]}),e.jsx(le,{size:16,className:"group-hover/btn:translate-x-1 transition-transform text-indigo-500"})]})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8 items-start",children:[e.jsx("div",{className:"hidden lg:block lg:col-span-3 sticky top-6 z-10",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden flex flex-col h-[calc(100vh-140px)] max-h-[650px] transition-all hover:shadow-md",children:[e.jsxs("div",{className:"p-4 bg-slate-50/80 border-b border-slate-100 flex items-center justify-between backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 font-bold text-slate-800",children:[e.jsx(ae,{size:18,className:"text-indigo-600"}),e.jsx("span",{children:"课程导航"})]}),e.jsx("span",{className:"text-[10px] bg-white border border-slate-200 text-slate-500 px-2 py-0.5 rounded-md font-mono shadow-sm",children:"NAV"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-2 bg-white",children:e.jsx(ve,{data:F,onSelect:t=>{N(t),h(1)},current:x})}),e.jsx("div",{className:"p-3 bg-slate-50 border-t border-slate-100 text-center",children:e.jsx("p",{className:"text-[10px] text-slate-400",children:"选择分类展开课程"})})]})}),e.jsxs("div",{className:"lg:col-span-9 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-2 shadow-sm border border-slate-100 flex flex-col md:flex-row items-center justify-between gap-3 sticky top-2 z-20 backdrop-blur-xl bg-white/90",children:[e.jsx("div",{className:"flex items-center p-1.5 bg-slate-100/80 backdrop-blur-sm rounded-2xl overflow-x-auto w-full md:w-auto scrollbar-hide",children:ke.map(t=>e.jsxs("button",{onClick:()=>{s(t),h(1)},className:`
                     relative px-5 py-2 rounded-xl text-sm font-semibold transition-all whitespace-nowrap z-10
                     ${l===t?"text-indigo-600 bg-white shadow-sm ring-1 ring-black/5":"text-slate-500 hover:text-slate-700 hover:bg-slate-200/50"}
                   `,children:[l===t&&e.jsx(f.div,{layoutId:"activeTab",className:"absolute inset-0 bg-white rounded-xl shadow-sm -z-10"}),t]},t))}),e.jsxs("div",{className:"relative w-full md:w-64 group",children:[e.jsx("input",{type:"text",placeholder:"搜索资源...",className:"w-full pl-9 pr-4 py-2 bg-slate-50 border border-transparent focus:bg-white focus:border-indigo-500 rounded-xl text-sm transition-all outline-none",value:a,onChange:t=>{i(t.target.value),h(1)}}),e.jsx(ie,{className:"absolute left-3 top-2.5 text-slate-400 group-focus-within:text-indigo-500 transition-colors",size:16})]})]}),e.jsxs("div",{className:"min-h-[400px]",children:[C&&e.jsxs("div",{className:"bg-rose-50 text-rose-600 p-4 rounded-xl flex items-center gap-2 mb-4 border border-rose-100",children:[e.jsx(re,{size:18})," ",C]}),$?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-5",children:[1,2,3,4,5,6].map(t=>e.jsx(ye,{},t))}):I.length>0?e.jsx(f.div,{variants:H,initial:"hidden",animate:"visible",className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-5",children:e.jsx(L,{mode:"popLayout",children:I.map(t=>e.jsxs(f.div,{layout:!0,variants:O,whileHover:{y:-4,transition:{duration:.2}},className:"bg-white rounded-2xl border border-slate-100 p-5 shadow-sm hover:shadow-md transition-all group flex flex-col h-full relative",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx(Ne,{title:t.title}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-slate-800 font-bold text-sm leading-snug line-clamp-2 group-hover:text-indigo-600 transition-colors",title:t.title,children:t.title}),e.jsx("div",{className:"flex items-center gap-2 mt-2",children:e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-[10px] font-medium bg-slate-100 text-slate-500 truncate max-w-full border border-slate-200",children:[e.jsx(je,{size:10,className:"mr-1"}),V[t.course]||t.course]})})]})]}),e.jsxs("div",{className:"mt-auto pt-3 border-t border-slate-50 flex gap-2",children:[e.jsxs(A,{to:`/student/resources/${t.id}`,className:"flex-1 h-9 bg-slate-50 hover:bg-slate-100 text-slate-600 rounded-lg text-xs font-semibold flex items-center justify-center gap-1 transition-colors group/btn",children:[e.jsx(ne,{size:14,className:"group-hover/btn:scale-110 transition-transform"})," 详情"]}),t.fileUrl?e.jsxs("button",{onClick:d=>U(d,t.id,t.fileUrl),className:"relative z-10 flex-1 h-9 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg text-xs font-semibold flex items-center justify-center gap-1 shadow-sm shadow-indigo-200 transition-colors group/btn",children:[e.jsx(de,{size:14,className:"group-hover/btn:translate-y-0.5 transition-transform"})," 下载"]}):e.jsx("button",{disabled:!0,className:"flex-1 h-9 bg-slate-100 text-slate-400 rounded-lg text-xs font-semibold cursor-not-allowed",children:"无文件"})]})]},t.id))})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 bg-white rounded-2xl border border-dashed border-slate-200",children:[e.jsx("div",{className:"bg-slate-50 p-4 rounded-full mb-3 ring-1 ring-slate-100",children:e.jsx(fe,{size:32,className:"text-slate-300"})}),e.jsx("h3",{className:"text-slate-900 font-medium",children:"没有找到相关资源"}),e.jsx("p",{className:"text-slate-500 text-sm mt-1 mb-4",children:"尝试切换课程或更改搜索关键词"}),e.jsx("button",{onClick:()=>{s("全部"),i(""),N("all")},className:"px-4 py-2 bg-indigo-50 text-indigo-600 rounded-lg text-sm font-semibold hover:bg-indigo-100 transition-colors",children:"清除所有筛选"})]})]}),e.jsx("div",{className:"flex justify-center pt-2 pb-8",children:e.jsx(B,{page:u,pageSize:p,total:v.length,onChange:h})})]})]})]})}export{qe as default};
